{
  "id": "http://arxiv.org/abs/2303.14705v1",
  "title": "Control of synaptic plasticity via the fusion of reinforcement learning and unsupervised learning in neural networks",
  "authors": [
    "Mohammad Modiri"
  ],
  "abstract": "The brain can learn to execute a wide variety of tasks quickly and\nefficiently. Nevertheless, most of the mechanisms that enable us to learn are\nunclear or incredibly complicated. Recently, considerable efforts have been\nmade in neuroscience and artificial intelligence to understand and model the\nstructure and mechanisms behind the amazing learning capability of the brain.\nHowever, in the current understanding of cognitive neuroscience, it is widely\naccepted that synaptic plasticity plays an essential role in our amazing\nlearning capability. This mechanism is also known as the Credit Assignment\nProblem (CAP) and is a fundamental challenge in neuroscience and Artificial\nIntelligence (AI). The observations of neuroscientists clearly confirm the role\nof two important mechanisms including the error feedback system and\nunsupervised learning in synaptic plasticity. With this inspiration, a new\nlearning rule is proposed via the fusion of reinforcement learning (RL) and\nunsupervised learning (UL). In the proposed computational model, the nonlinear\noptimal control theory is used to resemble the error feedback loop systems and\nproject the output error to neurons membrane potential (neurons state), and an\nunsupervised learning rule based on neurons membrane potential or neurons\nactivity are utilized to simulate synaptic plasticity dynamics to ensure that\nthe output error is minimized.",
  "text": "1 \n \nControl of synaptic plasticity via the fusion of \nreinforcement learning and unsupervised learning in neural \nnetworks1 \nMohammad Modiri2  \n \n \n \nAbstract \nThe brain can learn to execute a wide variety of tasks quickly and efficiently. \nNevertheless, most of the mechanisms that enable us to learn are unclear or incredibly \ncomplicated. Recently, considerable efforts have been made in neuroscience and \nartificial intelligence to understand and model the structure and mechanisms behind \nthe amazing learning capability of the brain. However, in the current understanding of \ncognitive neuroscience, it is widely accepted that synaptic plasticity plays an essential \nrole in our amazing learning capability. This mechanism is also known as the Credit \nAssignment Problem (CAP) and is a fundamental challenge in neuroscience and \nArtificial Intelligence (AI). The observations of neuroscientists clearly confirm the \nrole of two important mechanisms including the error feedback system and \nunsupervised learning in synaptic plasticity. With this inspiration, a new learning rule \nis proposed via the fusion of reinforcement learning (RL) and unsupervised learning \n(UL). In the proposed computational model, the nonlinear optimal control theory is \nused to resemble the error feedback loop systems and project the output error to state \nof neurons, and an unsupervised learning rule based on state of neurons or activity of \nneurons are utilized to simulate synaptic plasticity dynamics to ensure that the output \nerror is minimized.  \n \nKeywords: learning rule, reinforcement learning, unsupervised learning, neural \nnetwork, nonlinear control. \n                                                           \n1 This article is part of a new learning rule that shared to get feedback from researchers. \n2  Email address: Mohammad.Modiri@Gmail.com \n2 \n \n1. Proposed framework \nIn this section, we propose a novel brain-inspired learning rule. The main idea is to \ncombine a RL-based method and unsupervised learning to control synaptic plasticity. \nFig. 1 shows the main ideas underlying this computational model that can be applied \nin different tasks such as classification, prediction, and robotics. \nIn the proposed computational model, learning law reformulated as an optimal \ncontrol problem. For this purpose, all tasks even classification assumed as a dynamic \nsystem that illustrated in Fig. 1 (C). Since the NNs can be considered a special class \nof high-dimensional nonlinear dynamic systems, where both state and time are \ncontinuous. Therefore, continuous-time formulation of the HJB equation and ADP \ncan be applied to derive the learning rule (optimal control law). The derived learning \nrule forces the proposed framework's output to mimic the reference trajectory that \nimplicitly minimized the cross-entropy. The following subsections elaborate on the \nnetwork architecture, and the learning rule in further detail. \n1.1 Network architecture and dynamics \nThe proposed computational model consists of a feedforward and feedback \npathway. The feedforward pathway can be any form of neural network, however a \nthree parts module composed of an input layer, a neural network (NN), and an output \nlayer is recommended. The feedback pathway also different types of Actor-Critic or \nCritic only can be employed, although an Actor-Critic is recommended. \nFig. 1 shows the block diagram of the proposed computational model architecture. \nThe functionality of the proposed architecture is based on the following steps: \na. \nThe encoding layer projects input patterns ùë•(ùë°) into the NN.  \nb. In the pertaining process, a supervised learning algorithm like Gradient descent, \nRidge, etc., can be employed to adjust the decoder parameters associated with \neach training sample. Once the decoder is trained, it is considered constant \nduring the NN training process. (Optional) \nc. \nIn the NN training process. An RL-based method and unsupervised learning are \nproposed in subsection 1.2 is applied to make the NN learn temporal relations \n3 \n \nbetween the input patterns ùë•(ùë°)  and desired output ùë¶(ùë°) by adjusting the state \n(membrane potential) of neurons and consequently parameters in the NN using a \nnovel learning rule. In the proposed error feedback mechanism, two RC-based \nactor and critic are utilized to approximate true state of neurons and NN \nparameters. \nd. Model recall on new data. \nThe feedforward pathway resembles the structure of traditional neural networks, \nnevertheless the approach of the feedback pathway particularly proposed in this study \ndiffers considerably from classical artificial intelligence methods [1].  \n \n \nFig. 1. A schematic of the proposed architecture (plastic weights in red). (A) The feedforward pathway \nconsists of an encoding layer with fix and random parameters, a NN with trainable parameter and a decoder \nlayer, which is trained in the pre-training process and stay constant during the NN training process. (B) In \nthe feedback pathway, the nonlinear optimal control is applied for estimating state (membrane potential) of \nneurons and consequently NN parameters. It consists of actor and critic neural networks. (C) The subplots \nshows the reference trajectories and learned trajectories in difference tasks. \n \nRemark 1 For the sake of brevity, time dependence is suppressed while denoting \nvariables of dynamical systems. For instance, the notations ùë•(ùë°), ùë¶(ùë°), ùë¢(ùë°), ùë£(ùë°) and \nùëí(ùë°) are rewritten as ùë•, ùë¶, ùë¢, ùë£  and ùëí. Moreover, all math symbols used in this study \nare listed in Table 1. \n \n4 \n \nTable 1 The math symbols used in this paper and corresponding meanings \n \nSymbol \nMeaning \nùíèùíì \nNumber of neurons \nùëµùíì \nNumber of connections \nùíô \nInput pattern \nùíö \nDesired output  \nùíöÃÇ \nEstimated output \nùíÜ \nOutput error \nùëæùë¨ \nEncoder connections \nùëæùë´ \nDecoder connections \nùëæùíì \nNetwork connections \nùíóùíÖ \nDesirable state (membrane potential) of neuron \nùíóùíÜ \nDifference between desirable and estimated state (membrane potential) of \nneuron \nùíí \nùë¨ \nfiltered spike activity of input in spiking NN  \nand is equal to input in non-spiking NN \nùíí \n ùíì \nfiltered spike activity of reservoir in spiking NN and is equal to state in non-\nspiking neurons \nùë∫  \nspike train in spiking NN \nùõô(‚àô) \nLeaky term \n‚àÖ(‚àô) \nActivation function \nùìµ(‚àô.‚àô) \nUtility function \nùíá(‚àô) \nDrift dynamic function \nùíà(‚àô) \nInput dynamic \nùìó(‚àô.‚àô.‚àô) \nHamiltonian function \nùíñ‚àó \nDesirable state (membrane potential) of neuron \nùíñ \nAdmissible policy \nùíñùüê \nEstimated state (membrane potential) of neuron (input control) \nùëΩ‚àó \nOptimal cost function \nùëΩ \nCost function \nùëΩùíó\n  \nDerivative of the cost function \nùëæ\nÃÇùüè \nCritic weights \nùëæ\nÃÇùüê \nActor weights \nùú∂ùüè \nLearning rate of the actor \nùú∂ùüê \nLearning rate of the critic \n \n \n \nAs illustrated in Fig. 1, The core element of the proposed computational model is a \nneural network with the adjacency matrix ùëäùëü‚àà‚Ñùùëõùëü√óùëõùëü. Here, the NN consists of ùëõùëü \nneurons, for which the membrane potential dynamics are described as: \n(1) \nùúêÃá ùëñ= œà(ùë£ùëñ) + Œôùëñ \n \n \n5 \n \n(2) \nùêºùëñ= ùëäùëñ\nùê∏‚àÖ(ùë£ \nùê∏) + ùëäùëñ\nùëü‚àÖ(ùë£) \n \n \n,where ùúê= [ùúê1. ùúê2. ‚ãØ. ùúêùëõùëü] ‚àà‚Ñùùëõùëü is the state (membrane potential) of neuron of \nthe NN neurons,  ‚àÖ(‚àô) is a nonlinear dendrite, and, œà(ùúê): ‚Ñùùëõùëü‚Üí‚Ñùùëõùëü is a leak-term \nwhere we used ‚àíùõºùëôùë£, ùë£ \nùê∏, ùë£ \n ùëü in non-spiking neurons are directly equal to input ùë• and \nNN state ùúê, and in spiking neurons ùë£ùëñ\n  shows the filtered spike activity of neuron ùëñ. \nùëÜùëñ\n \n (ùë°) is the spike train of the neuron ùëñ and modelled as a sum of Dirac delta-\nfunctions: \n(3) \nùëûùëñ\n = (ùëÜùëñ\n \n ‚àóùúÖ)(ùë°) = ‚à´\nùëÜùëñ\n (ùë†)ùúÖ(ùë°‚àíùë†)ùëëùë†\nùë°\n‚àí‚àû\n   \n \n \n(4) \nùúÖ(ùë°) = exp (‚àíùë°/ùúè)/ùúè  \n  \n \nIn additional, a linear decoder is supposed as: \n(5) \nùë¶ÃÇ = ‚Ñé(ùë£) = ùëäùê∑ùë£  \n \n \n \n \n1.2 Synaptic plasticity mechanism \nThe equations mentioned in section 1.1 shows that the NN synaptic plasticity \nmechanism can be modeled as a dynamical system. Thus, principles of optimal \ncontrol theory can be utilized to derive a learning rule (optimal control law). For this \npurpose, we reformulate the AI tasks as a control problem. Therefore, the output error \nwere considered as follows: \n(6) \nùëí= ùë¶ÃÇ ‚àíùë¶‚àà‚Ñùùëê \n \n, where ùë¶‚àà‚Ñùùëê denotes the desired output at time ùë°, ùë¶ÃÇ ‚àà‚Ñùùëê is the corresponding \npredicted output, and ùëê is a number of output variables. By derivation of Eq. (6) with \nrespect to  ùë°, the error dynamics can be written as: \n(7) \nùëíÃá = ùë¶ÃÇÃá ‚àíùë¶Ãá  ‚àà‚Ñùùëê  \n  \n \n \n  \n \n \nThus, the error dynamics only depend on the NN neural dynamics is equal to: \n \n6 \n \n(8) \nùëíÃá = ùëäùê∑ùë£Ãá ‚àíùëäùëë\nùê∑ùë£Ãáùëë\n= ùëäùê∑[œà(ùë£(ùë°)) + ùëäùê∏ùë£ \nùê∏(ùë°) + ùëäùëü(ùë°)ùë£(ùë°)]  \n‚àíùëäùëë\nùê∑[œàùëë(ùë£(ùë°)) + ùëäùëë\nùê∏ùë£ \nùê∏(ùë°) + ùëäùëë\nùëü(ùë°)ùë£ùëë(ùë°)] \n \nAssumption 1 Assume the following simplification conditions: \n(9) \nùëäùëë\nùê∏= ùëäùê∏ \nùëäùëë\nùê∑= ùëäùê∑ \n \n \nAccording to Assumption 1, the error dynamics only depend on the NN.  \n \n(10) \nùëíÃá = ùëäùê∑[œàùëí(ùë£(ùë°)) + ùëäùëü(ùë°)ùë£ùëì(ùë°)] = ùëäùê∑ùë£Ãáùëí \n  \n \n \nWe assumed: \n(11) \nœàùëí(ùë£(ùë°)) = ùëì(ùë£(ùë°)) \n  \nùëäùëü(ùë°) = ùëî(ùë£(ùë°)) \nùë¢ùëü(ùë°) = ùë£(ùë°) ‚àíùë£ùëë(ùë°) = ùë£ùëì(ùë°) \n \n \nTherefore, neural space Eq. (8) can be rewritten as the following affine state space \nequation from: \n(12) \nùëíÃá = ùëäùê∑ùë£Ãáùëí= ùëäùê∑[ùëì(ùë£(ùë°)) + ùëî(ùë£(ùë°))ùë¢ùëü(ùë°)] \n  \n \n \nWhere the control input is considered as state of neurons changes ùë£Ãá(ùë°) and ùë§ùëü are \nfunction of control input of the NN, and ùë¢ùëü, ùëäùëü which the number are selected \naccording to the problem: \n(13) \nùë¢ùëü= [ùë¢ùëì; ùë¢] ‚àà‚Ñùùëõùëü \n \n \n  \n \n \n(14) \nùëäùëü= [ùëäùëì; ùëä] ‚àà‚Ñùùëõùëü√óùëõùëü \n \n \n  \n \n \n7 \n \n, in ùë¢‚àà‚Ñùùëõùëü‚àíùëõùëì and ùëä‚àà‚Ñù(ùëõùëü‚àíùëõùëì)√ó(ùëõùëü‚àíùëõùëì) is fixed or even zero NN \nparameters, ùë¢‚àà‚Ñùùëõ and ùëä‚àà‚Ñùùëõ√óùëõ  is the NN control input and synaptic plasticity \nrespectively and [ùë•; ùë¶] means combination of ùë• and ùë¶.  \nIn the artificial intelligence (AI) tasks, the goal of learning is to adapt the NN‚Äôs \nparameters ùëäùëü such that the error is minimized and the NN‚Äôs parameters and control \ninput remains bounded. Thus, the following cost function was considered: \n \n(15) \nmin\nùë¢(‚àô)‚ààùëà‚Ñë(ùëí(‚àô). ùë¢(‚àô)) = ‚à´\n‚Ñì(ùëí(ùúè). ùë¢(ùúè))ùëëùúè\nùë°ùëì\nùë°\n  \n  \n \n \n(16) \n‚Ñì(ùëí. ùë¢) = ùëíùëáùëÑùëí+ ùë¢ùëáùëÖùë¢‚âà‚Ñì(ùë£ùëí. ùë¢) = ùë£ùëí\nùëáùëÑùë£ùëí+ ùë¢ùëáùëÖùë¢   \n \n \n, wherein ‚Ñì(‚àô.‚àô) is the utility function, ùë°ùëì is the final time or last element of input \npatterns, ùëÑ. ùëÖ symmetric positive definite matrix for ensuring that the error in cost \nfunction is sufficiently affective. Hence, the optimal value function can be written: \n \n(17) \nùëâ(ùëí) ‚âàùëâ(ùë£ùëí) = ùêºùëõùëì\nùë¢(‚àô)‚ààùëà\n‚Ñë(ùë¢. ùë£ùëí)   \n \nUltimately, it is ideal to achieve an optimal input control  ùë¢‚àó or ùë£ùëí\n‚àó and weight \nupdate law ùëî‚àó(ùë£) that stabilizes the system Eq. (10) and minimizes the cost function \nEq. (17). This kind of input control ùë¢ is called admissible control [2].  \nNow, the learning rule has been reformulated given the error dynamic in Eq. (10) \nand the cost function Eq. (17). To solve this dynamic optimization problem, the HJB \nequation is utilized, so the Hamiltonian of the cost function Eq. (17)  associated with \ncontrol input ùë¢ is defined as: \n \n(18) \n‚Ñã(ùë£ùëí. ùë¢. ùëâùëí\n  ) = ‚Ñì(ùë£ùëí. ùë¢) + ùëâùëí\nùëá(ùë£ùëíÃá ) \n \n \n, where ùëâùëí\n = ùúïùëâ/ùúïùëí is the partial derivative of the cost function, for admissible \ncontrol policy ùúá we have: \n \n(19) \n‚Ñã(ùë£ùëí. ùúá. ùëâùëí\n  ) = 0 \n \n8 \n \nThe present study assumed that the solution to Eq. (19) is smooth giving the \noptimal cost function: \n(20) \nùëâ‚àó(ùëí) ‚âàùëâ‚àó(ùë£ùëí) = min\nùë¢(‚à´\n‚Ñì(ùë¢(ùúè). ùë£ùëí(ùúè))ùëëùúè\nùë°ùëì\nùë°\n) \n \n \n, which satisfies the HJB equation \n \n(21) \nùëöùëñùëõ\nùë¢  ‚Ñã(ùë£ùëí. ùë¢. ùëâùëí\n‚àó ) = 0 \n \nAssuming that the minimum on the left hand side Eq. (21) exists then by applying \nstationary condition ùúï‚Ñã(ùë£ùëí. ùë¢. ùëâùëí\n  ) ùúï\n‚ÅÑ ùë¢= 0, the learning rule (optimal control)  can \nbe obtained as: \n(22) \nùë¢‚àó(ùëí) ‚âàùë¢‚àó(ùë£ùëí) = ‚àí1\n2 ùëÖ‚àí1ùëîùëá(ùë£) ùëâùëí\n‚àó \n \nThe optimal value function can be obtained as: \n(23) \nùëâ‚àó(ùë£ùëí) = min\nùë¢(‚à´\nùë£ùëí\nùëáùëÑùë£ùëí+ ùë¢‚àóùëáùëÖùë¢‚àóùëëùúè\nùë°ùëì\nùë°\n) \n \nInserting this optimal learning rule Eq. (22) into nonlinear Lyapunov equation \nEq.(18) gives the formulation of the HJB equation Eq.  (21) in terms of ùëâùëí\n‚àó \n \n(24) \n0 = ùë£ùëí\nùëáùëÑùë£ùëí+ ùëâùëí\n‚àóùëá(ùë£ùëí)ùëì(ùë£) ‚àí1\n4 ùëâùëí\n‚àóùëá(ùë£ùëí)ùëî(ùë£)ùëÖ‚àí1ùëîùëá(ùë£)ùëâùëí\n‚àó(ùë£ùëí) \n \n \nFinding the error feedback mechanism to stabilize the NN requires solving the HJB \nequation for the value function and then substituting the solution to obtain the desired \nstate of neurons update and consequently learning rule. Although HJB gives the \nnecessary and sufficient condition for optimality of a learning rule (control law) with \nrespect to a loss function; Unfortunately, according to the nonlinear characteristics of \nthe NN, solving the HJB equation in explicit form is difficult or even impossible to \nderive for systems of interest in practice. However, a few solution such as Feynman-\nKac lemma, Al‚Äôbrecht, Garrard, Viscosity, Games based, Adaptive Dynamic \nProgramming (ADP) methods have been proposed to solve HJB approximately. \nMeanwhile, ADP offers a data driven solution that is more homogeneous with \n9 \n \nproposed framework. Thus, the proposed computational focuses on the ADP method \nto approximate its solution. To address this mater, with the inspiration of the \ndopaminergic region structure and conformity with the Weierstrass high-order \napproximation theorem [3], we utilized a new actor-critic based on the seminal \nReservoir Computing (s-RC) that proposed in [4]. Briefly, the objective of tuning the \nactor weights is to minimize the approximate value, and the objective of tuning the \ncritic weights is to minimize the Bellman equation error. \nTherefore, a s-RC is used as critic to approximate the derivatives of the value \nfunction: \n(25) \nùëâùëí\n  (ùëí) ‚âàùëâùë£ùëí\n  (ùë£ùëí) = ùëäùëê\nùê∑ ùëßùëê+ ùúÄùëê‚àà‚Ñùùëê√ó1 \nùëßùëê‚àà‚Ñùùëõùëê√ó1 \nùëäùëê\nùê∑‚àà‚Ñù ùëê√óùëõùëê \n \n \nWhere ùëäùëê\nùê∑ is the decoder weight, and ùëßùëê is a representation of input ùë£ùëí. By \napplying the gradient descent algorithm, critic weight update rule will be: \n(26) \nùëäÃÇÃá\nùëê\nùê∑= ‚àíùõºùëê\nùúïùê∏ùëê\nùúïùëäÃÇùëêùê∑= ‚àíùõºùëê(ùëì(ùë£) + ùëî(ùë£)ùë¢)ùëßùëê\nùëá ùëíùëê\n= ‚àíùõºùëêùúéùëê(ùúéùëê\nùëáùëäÃÇùëê\nùê∑+ ùë£ùëí\nùëáùëÑùë£ùëí+ ùë¢ùëáùëÖùë¢) \n \nLet ùëäÃÇùëê\nùê∑ is an estimation of unknown matrix ùëäùëê\nùê∑, ùõºùëê> 0 is critic learning rate, and \nùúéùëê= (ùëì(ùë£) + ùëî(ùë£)ùë¢)ùëßùëê\nùëá. \nSimilarly, one more s-RC is utilized as the actor to approximate the state \n(membrane potential) of neurons: \n(27) \nùë¢(ùë£ùëí) = ùëäùëé\nùê∑ ùëßùëé+ ùúÄùëé‚àà‚ÑùùëÅ√ó1 \nùëßùëé‚àà‚Ñùùëõùëé√ó1 \nùëäùëé\nùê∑‚àà‚ÑùùëÅ√óùëõùëé \n \n \nWhere ùëßùëé be the new representation of input ùë£ùëí,   ùëäÃÇùëé\nùê∑ an estimation of unknown \nmatrix ùëäùëé\nùê∑. By using the gradient descent algorithm, a weight update expression for \nthe actor can be written as follows: \n(28)\n \nùëäÃÇÃá\nùëé\nùê∑= ‚àíùõºùëé\nùúïùê∏ùëé\nùúïùëäÃÇùëéùê∑= ‚àíùõºùëé(ùëäÃÇùëé\nùê∑ùëßùëé+ 1\n2 ùëÖ‚àí1ùëîùëá(ùë£)(ùëäÃÇùëê\nùê∑ùëßùëê))ùëßùëé\nùëá \n \nWhere ùõºùëé> 0 is actor learning rate. \n10 \n \n \nConsequently, in the course of the NN learning process, the feedback pathway \nforces the output of the computational model to follow the reference trajectory, an \neffect that is widely used in control theory. After an adequate learning time, the \nfeedforward pathway in the absent of feedback pathway can fallow desirable patterns \nwith acceptable accuracy. \nThe stability and convergence of the proposed framework and error can be \ninvestigated similar to [4]. However, there is an important issue that should be noted, \nwhere unlike the [4], the ùëî(‚àô) is not clearly specified. Although, varied candidate \nsolutions that can be unsupervised learning such as the bounded spike timing \ndependent plasticity (STDP) can be suggested. Nevertheless, a comprehensive \ninvestigation requires for providing an ideal solution for ùëî(‚àô), which is ignored in the \ncurrent version of article. \n \n \n11 \n \nReferences \n \n[1]  M. Modiri, M. M. Homayounpour and M. M. Ebadzadeh, \n\"Reservoir \nweights \nlearning \nbased \non \nadaptive \ndynamic \nprogramming and its application in time series classification,\" \nNeural Computing & Applications, 2020.  \n[2]  M. Khalaf and F. L. Lewis, \"Nearly optimal control laws for \nnonlinear systems with saturating actuators using a neural network \nHJB approach,\" Automatica, vol. 41, no. 5, pp. 779-791, 2005.  \n[3]  A. Finlayson, The method of weighted residuals and variational \nprinciples, New York: Academic Press, 1990.  \n[4]  M. Modiri, \"Control of synaptic plasticity in neural networks,\" \narXive.org, 2023.  \n[5]  H. K. Khalil, Nonlinear Control, Edinburgh: Pearson, 2014.  \n[6]  S. Ge, C. Hang and T. Zhang, \"Adaptive neural network control of \nnonlinear systems by state and output feedback,\" IEEE Transactions \non Systems, Man, and Cybernetics, vol. 29, no. 6, pp. 818-828, \n1999.  \n \n \n \n \n",
  "categories": [
    "cs.NE",
    "cs.AI",
    "cs.LG",
    "cs.RO",
    "cs.SY",
    "eess.SY"
  ],
  "published": "2023-03-26",
  "updated": "2023-03-26"
}